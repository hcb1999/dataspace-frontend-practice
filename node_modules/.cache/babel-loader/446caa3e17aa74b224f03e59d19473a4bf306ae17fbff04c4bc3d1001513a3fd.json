{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useState, createContext, useContext } from 'react';\nimport { io } from 'socket.io-client';\nimport { useNotification } from './NotificationContext';\nimport environmentConfig from '../config/config';\nconst SocketContext = /*#__PURE__*/createContext();\nexport const useSocket = () => {\n  _s();\n  return useContext(SocketContext);\n};\n_s(useSocket, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const SocketProvider = ({\n  children\n}) => {\n  _s2();\n  const {\n    showNotification\n  } = useNotification();\n  const [socket, setSocket] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  useEffect(() => {\n    const connectedWallet = localStorage.getItem('walletAddress');\n    const newSocket = io(environmentConfig.apiUrl, {\n      transports: ['websocket'],\n      secure: true\n    });\n    setSocket(newSocket);\n    newSocket.on('connect', () => {\n      if (connectedWallet) {\n        newSocket.emit('registerWallet', connectedWallet);\n      }\n    });\n    newSocket.on('transactionResult', result => {\n      setIsLoading(true);\n      setTimeout(() => {\n        if (result.status === 'success') {\n          if (result.type === 'Mint & VC Issue') {\n            showNotification('success', '에셋 발행 성공', 'NFT 발행이 성공적으로 완료되었습니다.');\n          } else {\n            showNotification('success', '에셋 구매 성공', 'NFT 이전이 성공적으로 완료되었습니다.');\n          }\n        } else if (result.status === 'failed') {\n          if (result.type === 'Mint') {\n            showNotification('error', '에셋 발행 실패', 'NFT 발행이 실패했습니다.');\n          } else {\n            showNotification('error', '에셋 구매 실패', 'NFT 이전이 실패했습니다.');\n          }\n        }\n        setIsLoading(false);\n      }, 2000);\n    });\n    return () => {\n      newSocket.disconnect();\n    };\n  }, [showNotification]);\n  return /*#__PURE__*/React.createElement(SocketContext.Provider, {\n    value: {\n      socket,\n      isLoading\n    }\n  }, children);\n};\n_s2(SocketProvider, \"3bfAjZgncmjTN+kjn9byFkM+5Fs=\", false, function () {\n  return [useNotification];\n});\n_c = SocketProvider;\nvar _c;\n$RefreshReg$(_c, \"SocketProvider\");","map":{"version":3,"names":["React","useEffect","useState","createContext","useContext","io","useNotification","environmentConfig","SocketContext","useSocket","_s","SocketProvider","children","_s2","showNotification","socket","setSocket","isLoading","setIsLoading","connectedWallet","localStorage","getItem","newSocket","apiUrl","transports","secure","on","emit","result","setTimeout","status","type","disconnect","createElement","Provider","value","_c","$RefreshReg$"],"sources":["/home/avataroad/dataspace-frontend/src/context/SocketContext.js"],"sourcesContent":["import React, { useEffect, useState, createContext, useContext } from 'react';\nimport { io } from 'socket.io-client';\nimport { useNotification } from './NotificationContext';\nimport environmentConfig from '../config/config';\n\nconst SocketContext = createContext();\n\nexport const useSocket = () => {\n  return useContext(SocketContext);\n};\n\nexport const SocketProvider = ({ children }) => {\n  const { showNotification } = useNotification();\n  const [socket, setSocket] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    const connectedWallet = localStorage.getItem('walletAddress');\n    const newSocket = io(environmentConfig.apiUrl, {\n      transports: ['websocket'],\n      secure: true,\n    });\n\n    setSocket(newSocket);\n\n    newSocket.on('connect', () => {\n      if (connectedWallet) {\n        newSocket.emit('registerWallet', connectedWallet);\n      }\n    });\n\n    newSocket.on('transactionResult', result => {\n      setIsLoading(true);\n      setTimeout(() => {\n        if (result.status === 'success') {\n          if (result.type === 'Mint & VC Issue') {\n            showNotification('success', '에셋 발행 성공', 'NFT 발행이 성공적으로 완료되었습니다.');\n          } else {\n            showNotification('success', '에셋 구매 성공', 'NFT 이전이 성공적으로 완료되었습니다.');\n          }\n        } else if (result.status === 'failed') {\n          if (result.type === 'Mint') {\n            showNotification('error', '에셋 발행 실패', 'NFT 발행이 실패했습니다.');\n          } else {\n            showNotification('error', '에셋 구매 실패', 'NFT 이전이 실패했습니다.');\n          }\n        }\n        setIsLoading(false);\n      }, 2000);\n    });\n\n    return () => {\n      newSocket.disconnect();\n    };\n  }, [showNotification]);\n\n  return (\n    <SocketContext.Provider value={{ socket, isLoading }}>\n      {children}\n    </SocketContext.Provider>\n  );\n};\n\n\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,EAAEC,aAAa,EAAEC,UAAU,QAAQ,OAAO;AAC7E,SAASC,EAAE,QAAQ,kBAAkB;AACrC,SAASC,eAAe,QAAQ,uBAAuB;AACvD,OAAOC,iBAAiB,MAAM,kBAAkB;AAEhD,MAAMC,aAAa,gBAAGL,aAAa,CAAC,CAAC;AAErC,OAAO,MAAMM,SAAS,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC7B,OAAON,UAAU,CAACI,aAAa,CAAC;AAClC,CAAC;AAAAE,EAAA,CAFYD,SAAS;AAItB,OAAO,MAAME,cAAc,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,GAAA;EAC9C,MAAM;IAAEC;EAAiB,CAAC,GAAGR,eAAe,CAAC,CAAC;EAC9C,MAAM,CAACS,MAAM,EAAEC,SAAS,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAACe,SAAS,EAAEC,YAAY,CAAC,GAAGhB,QAAQ,CAAC,KAAK,CAAC;EAEjDD,SAAS,CAAC,MAAM;IACd,MAAMkB,eAAe,GAAGC,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC;IAC7D,MAAMC,SAAS,GAAGjB,EAAE,CAACE,iBAAiB,CAACgB,MAAM,EAAE;MAC7CC,UAAU,EAAE,CAAC,WAAW,CAAC;MACzBC,MAAM,EAAE;IACV,CAAC,CAAC;IAEFT,SAAS,CAACM,SAAS,CAAC;IAEpBA,SAAS,CAACI,EAAE,CAAC,SAAS,EAAE,MAAM;MAC5B,IAAIP,eAAe,EAAE;QACnBG,SAAS,CAACK,IAAI,CAAC,gBAAgB,EAAER,eAAe,CAAC;MACnD;IACF,CAAC,CAAC;IAEFG,SAAS,CAACI,EAAE,CAAC,mBAAmB,EAAEE,MAAM,IAAI;MAC1CV,YAAY,CAAC,IAAI,CAAC;MAClBW,UAAU,CAAC,MAAM;QACf,IAAID,MAAM,CAACE,MAAM,KAAK,SAAS,EAAE;UAC/B,IAAIF,MAAM,CAACG,IAAI,KAAK,iBAAiB,EAAE;YACrCjB,gBAAgB,CAAC,SAAS,EAAE,UAAU,EAAE,wBAAwB,CAAC;UACnE,CAAC,MAAM;YACLA,gBAAgB,CAAC,SAAS,EAAE,UAAU,EAAE,wBAAwB,CAAC;UACnE;QACF,CAAC,MAAM,IAAIc,MAAM,CAACE,MAAM,KAAK,QAAQ,EAAE;UACrC,IAAIF,MAAM,CAACG,IAAI,KAAK,MAAM,EAAE;YAC1BjB,gBAAgB,CAAC,OAAO,EAAE,UAAU,EAAE,iBAAiB,CAAC;UAC1D,CAAC,MAAM;YACLA,gBAAgB,CAAC,OAAO,EAAE,UAAU,EAAE,iBAAiB,CAAC;UAC1D;QACF;QACAI,YAAY,CAAC,KAAK,CAAC;MACrB,CAAC,EAAE,IAAI,CAAC;IACV,CAAC,CAAC;IAEF,OAAO,MAAM;MACXI,SAAS,CAACU,UAAU,CAAC,CAAC;IACxB,CAAC;EACH,CAAC,EAAE,CAAClB,gBAAgB,CAAC,CAAC;EAEtB,oBACEd,KAAA,CAAAiC,aAAA,CAACzB,aAAa,CAAC0B,QAAQ;IAACC,KAAK,EAAE;MAAEpB,MAAM;MAAEE;IAAU;EAAE,GAClDL,QACqB,CAAC;AAE7B,CAAC;AAAAC,GAAA,CAlDYF,cAAc;EAAA,QACIL,eAAe;AAAA;AAAA8B,EAAA,GADjCzB,cAAc;AAAA,IAAAyB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}